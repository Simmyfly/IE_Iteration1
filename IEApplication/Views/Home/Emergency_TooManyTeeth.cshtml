
@{
    ViewBag.Title = "Dental Issues - Too Many Teeth";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script src="~/Content/js/jquery_3.3.1.js"></script>
<link href="~/Content/css/StyleSheet1.css" rel="stylesheet" />
<link href="~/Content/css/problems.css" rel="stylesheet" />
<link href="~/Content/css/font.css" rel="stylesheet" />
<script src="~/Content/js/showQuestion.js"></script>

<!--load script for google map-->
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDs7DFmUEpY4gmsmLmCIBNihn6trxxVChc&callback=initMap&libraries=places&language=en"></script>
<script>
    var map;
    function handleSetCenterButtonClicked(coords) {
        getMyLocation();
        map.setCenter(yourPos);
        map.setZoom(12);
    }
    function initMap() {
        var addButton = document.getElementById("get_location");
        addButton.onclick = handleSetCenterButtonClicked;
        //initialize the map
        var location = { lat: -27.469770, lng: 153.025131 };
        map = new google.maps.Map(document.getElementById("map"), {
        zoom: 8,
        center: location,
        });

        var marker_initial = new google.maps.Marker({
            postition: location,
            map:map
        })

        var restrictOptions = {
            componentRestrictions: { country: 'au' }
        };

        var searchBox = new google.maps.places.SearchBox(document.getElementById('from_places'));

        var markers = [];
        var contentString = [];
        var infowindow = [];
        var budget;
        $.get("@Url.Action("GetAllLocation","Home")", function (data, status) {
            for (var i = 0; i < data.length; i++) {

                markers[i] = new google.maps.Marker({
                    position: { lat: data[i].Lat, lng: data[i].Long },
                    map: map
                });
                contentString[i] = '<div id="content">' + '<div id="siteNotice">'
                    + '</div>' + '<h4 id="firstHeading">'+ data[i].clinicName +'</h1>' + '<div id="bodyContent">'
                    + '<p>is a public dental clinic. Please contact <strong>' + data[i].contact + '</strong> for appointments or enquiry.</p></div></div>';
                infowindow[i] = new google.maps.InfoWindow({
                    content: contentString[i]
                });
                var markerValue = markers[i]
                google.maps.event.addListener(markers[i], 'mouseover', (function (markerValue, i) {
                    return function () {
                        infowindow[i].open(map, markers[i]);
                    }
                })(markers[i], i));
                google.maps.event.addListener(markers[i], 'mouseout', (function (markerValue, i) {
                    return function () {
                        infowindow[i].close();
                    }
                })(markers[i], i));

            };


            var places;
            var from_places = new google.maps.places.Autocomplete(document.getElementById('from_places'), restrictOptions);

            //google.maps.event.addListener(from_places, 'place_changed', function () {
            //    var from_place = from_places.getPlace();
            //    var from_address = from_place.formatted_address;
            //    $('#origin').val(from_address);


            //})

            google.maps.event.addListener(searchBox, 'places_changed', function () {
                //console.log(searchBox.getPlaces());
                places = searchBox.getPlaces();

                //bound
                var bounds = new google.maps.LatLngBounds();
                var i, place;
                var contentString_initial = "<div style='color:green;'><strong>You are Here</strong></div>"
                var infowindow_initial = new google.maps.InfoWindow({
                    content: contentString_initial
                });
                infowindow_initial.open(map, marker_initial);

                for (i = 0; place = places[i]; i++) {
                    //console.log(place.geometry.location);
                    bounds.extend(place.geometry.location);
                    marker_initial.setPosition(place.geometry.location);
                };

                map.fitBounds(bounds);
                map.setZoom(11);

            })

            //calculate distance function
            $('#distance_form').submit(function (e) {
                e.preventDefault();
                calculateDistance();
            })

            var tbody = document.getElementById('tablebody');
            function calculateDistance() {
                var origin = $('#origin').val();
                var destinations = [];
                    destinations[0] = new google.maps.LatLng(data[0].Lat, data[0].Long);
                    var service = new google.maps.DistanceMatrixService();

                    service.getDistanceMatrix({
                        origins: [origin],
                        destinations: [destinations[0]],
                        travelMode: google.maps.TravelMode.DRIVING,
                        unitSystem: google.maps.UnitSystem.METRIC,
                        avoidHighways: false,
                        avoidTolls: false
                    }, function (response, status) {
                        if (status != google.maps.DistanceMatrixStatus.OK) {
                            $('#result').html(err);
                        } else {
                            //var origin = response.originAddresses[0];
                            var destination = response.destinationAddresses[0];
                            if (response.rows[0].elements[0].status === "ZERO_RESULTS") {
                                //$('#result').html("Better get on a plane. There are no roads between your location and the destination clinic: " + destination);
                                var newRow = tbody.insertRow(0);
                                newRow.innerHTML = "Better get on a plane.There are no roads between your location and the destination clinic ";
                            } else {
                                var distance = response.rows[0].elements[0].distance;
                                var duration = response.rows[0].elements[0].duration;
                                console.log(response.rows[0].elements[0].distance);
                                //var distance_in_kilo = distance.value / 1000;
                                var distance_in_meter = distance.value;
                                var cost = distance.value * 2;
                                var duration_text = duration.text;
                                //var duration_value = duration.value;
                                //$('#in_kilo').text(distance_in_kilo.toFixed(2));
                                var newRow = tbody.insertRow(0);
                                var tcell = newRow.insertCell(0);
                                tcell.innerHTML = data[0].clinicName;
                                var tcell2 = newRow.insertCell(1);
                                tcell2.innerHTML = distance_in_meter;
                                var tcell3 = newRow.insertCell(2);
                                tcell3.innerHTML = cost;
                                var tcell4 = newRow.insertCell(3);
                                tcell4.innerHTML = duration_text;
                                var tcell5 = newRow.insertCell(4);
                                tcell5.innerHTML = destination;
                                //$('#in_meter').text(distance_in_meter);
                                //$('#duration_text').text(duration_text);
                                //$('#from').text(origin);
                                //$('#to').text(destination);
                            }
                        }
                    });
                //}
                //var origin = new google.maps.LatLng(-26.74313, 153.138);

            }

        })
}

window.onload = initMap;

function getMyLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(displayLocation);
    } else {
        alert("Oops, no geolocation support");
    }
}

function displayLocation(position) {
    showMap(position.coords);
    var latitude = position.coords.latitude;
    var longitude = position.coords.longitude;
    var div = document.getElementById("location");
    div.innerHTML = "You are at Latitude: " + latitude + ", Longitude: " + longitude;
}

var yourPos;
function showMap(coords) {
    yourPos = googleLatAndLong;
    var googleLatAndLong = new google.maps.LatLng(coords.latitude, coords.longitude);
    var mapOptions = {
        zoom: 15,
        center: googleLatAndLong,
    };
    //var mapDiv = document.getElementById("map");
    //map = new google.maps.Map(mapDiv, mapOptions);
    map.setOptions(mapOptions);
    addMarker(googleLatAndLong);
}

var marker;
var markerArray = new Array();

function addMarker(latLong) {
    var markerOptions = {
        position: latLong,
        map: map
    };
    marker = new google.maps.Marker(markerOptions);

    markerArray.push(marker);
}
</script>


<!--load script for tabs-->
<script>
    // script for tab steps
    $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {

        var href = $(e.target).attr('href');
        var $curr = $(".process-model  a[href='" + href + "']").parent();

        $('.process-model li').removeClass();

        $curr.addClass("active");
        $curr.prevAll().addClass("visited");
    });
    // end  script for tab steps

</script>
<!--render scripts for information tab-->
<script>

        $(document).on("click", ".naccs .menu div", function () {
            var numberIndex = $(this).index();

            if (!$(this).is("active1")) {
                $(".naccs .menu div").removeClass("active1");
            $(".naccs ul li").removeClass("active1");

            $(this).addClass("active1");
            $(".naccs ul").find("li:eq(" + numberIndex + ")").addClass("active1");

            var listItemHeight = $(".naccs ul")
                .find("li:eq(" + numberIndex + ")")
                .innerHeight();
            $(".naccs ul").height(listItemHeight + "px");
        }
});

</script>

<div class="banner" style="background: url('../Content/img/cavities-banner.jpg') no-repeat center top;min-height:400px;">
    <div class="bg-color" style="min-height:400px;">
        <div class="container">
            <div class="row">
                <div class="banner-text text-center">
                    <div class="text-border" style="border:0px">
                        @*<h2 class="text-dec" style="padding-top:0px;padding-bottom:0px"><img src="~/Content/img/Logo.png" width="138px" height="70px" style="margin-top:0px;"></h2>*@
                    </div>
                    <div class="intro-para text-center quote" style="margin-top:0">
                        <p class="big-text" style="font-size:35px">Too Many Teeth</p>
                        <p class="small-text" style="width:60%;margin-left:20%;font-size:18px;">Too Many Teeth (Hyperdontia) is a condition that causes too many teeth to grow in your mouth, which are sometimes called supernumerary teeth</p>
    @*<a href="#courses" class="btn get-quote" style="font-size:21px">Select Your Dental Issu</a>*@
                    </div>
                    <a href="#courses" class="mouse-hover" style="display:none;">
                        <div class="mouse" style="display:none;"></div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<section class="design-process-section" id="process-tab">
    <div class="container" width="85%">
        <div class="row" width="90%">
            <div class="col-xs-12" width="100%">
                <!-- design process steps-->
                <!-- Nav tabs -->
                <ul class="nav nav-tabs process-model more-icon-preocess" style="max-width:800px" role="tablist">
                    <li role="presentation">
                        <a href='@Url.Action("Index", "Home")#courses'>
                            <i class="fa fa-search" aria-hidden="true"></i>
                            <p>Dental Problems</p>
                        </a>
                    </li>
                    <li role="presentation">
                        <a href='@Url.Action("TooManyTeeth", "Home")'>
                            <i class="fa fa-clipboard" aria-hidden="true"></i>
                            <p>Problem Details</p>
                        </a>
                    </li>
                    <li role="presentation">
                        <a href="@Url.Action("TooManyTeeth", "Home")#feature">
                            <i class="fa fa-qrcode" aria-hidden="true"></i>
                            <p>Category Selection</p>
                        </a>
                    </li>
                    <li role="presentation" class="active" id="priceTab">
                        <a href="#content" aria-controls="content" role="tab" data-toggle="tab">
                            <i class="fa fa-newspaper-o" aria-hidden="true"></i>
                            <p>Price and Budget</p>
                        </a>
                    </li>
                    <li role="presentation">
                        <a aria-controls="ClinicsMap" id="clinicsTab">
                            @*<a href="#reporting" aria-controls="reporting" role="tab" data-toggle="tab"/>*@
                            <i class="fa fa-send-o" aria-hidden="true"></i>
                            <p>Find Dental Clinics</p>
                        </a>
                    </li>
                </ul>
                <!-- end design process steps-->
                <!-- Tab panes -->
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane" id="discover">
                        <div class="design-process-content">
                            <h3 class="semi-bold">Dental Problems</h3>
                            <p></p>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="strategy">
                        <div class="design-process-content">

                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="optimization">
                        <div class="design-process-content">
                            <h3 class="semi-bold">Optimization</h3>
                            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincid unt ut laoreet dolore magna aliquam erat volutpat</p>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane active" id="content">
                        <div class="design-process-content" style="padding-right:3%">
                            <!--Pricing-->
                            <section id="pricing" class="section-padding" style="width:100%;margin:0;background: linear-gradient(141deg, #ccc 25%, #eee 40%, #ddd 55%);">
                                <div class="container">
                                    <div class="row">
                                        <div class="header-section text-center">
                                            <h2>Cost of Dental Treatment</h2>
                                            <p style="color:#4B4B4C;width:85%;margin-left:5%">Fees in dental clinic varies in different treatment items that is related to your dental problems.</p>
                                            <hr class="bottom-line">
                                            <p style="margin-bottom:25px"><strong>Estimated treatment cost is: </strong></p>
                                        </div>
                                        <div class="col-md-3 col-sm-3" style="margin-left:35%">
                                            <div class="price-table">
                                                <!-- Plan  -->
                                                <div class="pricing-head">
                                                    <h4>Extraction</h4>
                                                    <span class="fa fa-usd curency"></span> <span class="amount" style="font-size:32px">70~85</span>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <!--/ Pricing-->
                            <!--budget section-->
                            <div>
                                <div class="header-section text-center" style="margin-top:35px;padding-top:20px">
                                    <div id="fontbody" style="margin-top:0">
                                        <div class="font1">Get the best</div>
                                        <div class="font1">
                                            <span>of us by telling us your budget</span>
                                        </div>
                                    </div>
                                    @*<h2>GET THE BEST OF US BY TELLING US YOUR BUDGET</h2>*@
                                    <p style="margin-top:30px">Enter your budget to check out nearby dental service within your budget</p>
                                    <hr class="bottom-line">
                                </div>
                                <div class="container1">
                                    <div class="container__item">
                                        <form class="form1">
                                            <span style="font-size:23px;">$  </span><input type="number" min="1" max="999" id="input" class="form1__field" placeholder="Your budget (e.g. 200)" style="margin-top:28px;" />
                                            <button type="button" id="submitButton"
                                                    class="btn btn--primary btn--inside uppercase" style="font-size:18px">
                                                Submit
                                            </button>
                                        </form>
                                    </div>

                                    <div style="margin-top:30px;margin-left:70%">
                                        <h4>Do not have a budget in mind?</h4>
                                        <a href='@Url.Action("AllClinics", "Home")' class="btn btn--primary btn--inside uppercase" style="font-size:15px;padding:6px;">Check for all dental clinics></a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="ClinicsMap" style="display:none">
                        <div class="design-process-content" style="padding-right:0;width:1230px">
                            <div class="container" style="width:100%;margin-right:5px;">
                                <h2>Queensland Dental Clinics</h2>
                                <p style="font-size:18px"> In your case of dental treatment, usually would be treated as priority group and arranged in priority category waiting list.</p>
                                <p style="margin-bottom:20px;font-size:18px">Please select the region you are in to find your nearby dental clinics' contact details.</p>

                                <div style="display: inline-block;width:45%;left: 0;">

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div style="display:none"><a href="#" id="get_location">Get your current location</a></div>

                                            <!--a form for address input and result-->
                                            <form id="distance_form">
                                                <div class="form-group">
                                                    <label>Please enter your current location: </label>
                                                    <input type="text" id="from_places" class="form-control" placeholder="location or address(e.g.Sunshine Coast Airport)" style="width:320px" />
                                                    <input id="origin" type="hidden" name="origin" required />
                                                </div>
                                                <input type="submit" value="See nearby clinics" class="btn btn-primary" />
                                            </form>

                                            <div id="result" style="display:none;">
                                                <table style="width:100%">
                                                    <thead>
                                                        <tr>
                                                            <th>Dental Clinics</th>
                                                            <th>Distance</th>
                                                            <th data-type="numeric">Estimated Cost</th>
                                                            <th>Duration(by driving)</th>
                                                            <th>Adress
                                                            <th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="tablebody">
                                                        <tr>
                                                            <td>
                                                                Clinic Name :
                                                                <span id="clinic_name"></span>
                                                            </td>
                                                            <td>
                                                                Distance In Meter :
                                                                <span id="in_meter" class="badge badge-primary badge-pill"></span>
                                                                @*Distance is Kilo:
                                                                    <span id='in_kilo' class="badge badge-primary badge-pill"></span>*@
                                                            </td>
                                                            <td>
                                                                <span id="from"></span>
                                                            </td>
                                                            <td>
                                                                Duration:
                                                                <span id="duration_text" class="badge badge-primary badge-pill"></span>
                                                            </td>
                                                            <td>
                                                                TO:
                                                                <span id="to" style="width：100%"></span>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>


                                            </div>
                                            <a id="goBack" class="btn-submit" style="margin-top:500px;float:left;margin-left:10%;background-color:white;color:#5FCF80;font-weight:bolder;border: 2px solid #5fcf80;font-size:15px" href="#content"> Back to Budgets</a>
                                        </div>
                                    </div>
                                </div>
                                <!--section for map-->
                                <div style="display: inline-block;position:absolute;width:65%;right: 0;">
                                    <div id="map" style="height:600px;width:100%;margin:0;padding:0"></div>
                                    <div id="location"></div>

                                    <div height="30px"></div>
                                </div>

                                <a id="goBack" class="btn-submit" style="margin-bottom:0;float:right;margin-right:10%;background-color:white;color:#5FCF80;font-weight:bolder;border: 2px solid #5fcf80;font-size:15px" href="#content"> Back to Budgets</a>
                            </div>


                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>








